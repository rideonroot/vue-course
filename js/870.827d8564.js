"use strict";(self["webpackChunkvue_course"]=self["webpackChunkvue_course"]||[]).push([[870],{5227:function(e,r,l){l.d(r,{Bf:function(){return a},e8:function(){return t},m5:function(){return s},n8:function(){return n}});const a=e=>Object.entries(e).reduce(((e,[r,l])=>"string"===typeof l&&""===l?e:("number"!==typeof l||l)&&l?{...e,[r]:l}:e),{}),t=e=>Intl.NumberFormat().format(e),s=(e,r)=>r[e%100>4&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]],n=(e,r)=>e?.map((e=>{const l=e(r);return"string"===typeof l?l:""})).filter((e=>""!==e))},657:function(e,r,l){l.d(r,{L:function(){return c}});var a=l(2578),t=l(4870),s=l(3396),n=l(1885),u=l(6106),o=l(2474);const c=(0,a.Q_)("order",(()=>{const e=(0,u.L)(),{clearCart:r}=(0,o.x)(),l=(0,t.iH)({}),a=(0,t.qj)({inputs:{},message:""}),c=(0,t.iH)(!1),i=(0,t.iH)(!1),m=(0,s.Fl)((()=>l.value?.basket?.items?.length??0)),d=(0,s.Fl)((()=>l?.value?.basket?.items.reduce(((e,r)=>e+r.price*r.quantity),0)??0)),p=(0,s.Fl)((()=>Boolean(l.value?.id))),_=async t=>{try{a.message="",a.inputs={},i.value=!1,c.value=!0,l.value=await n.Z.createOrder(t,e.accessKey),r()}catch({error:s}){a.message=s?.message??"",a.inputs=s?.request??{},i.value=!0}finally{c.value=!1}},v=async r=>{if(!p.value)try{c.value=!0,i.value=!1,l.value=await n.Z.getOrder(r,e.accessKey)}catch{i.value=!0}finally{c.value=!1}};return{isLoading:c,isError:i,order:l,itemsCount:m,totalPrice:d,errors:a,createOrder:_,getOrder:v}}))},6213:function(e,r,l){l.d(r,{Z:function(){return m}});var a=l(3396),t=l(7139);const s=e=>((0,a.dD)("data-v-6cd2041e"),e=e(),(0,a.Cn)(),e),n=s((()=>(0,a._)("span",{class:"loader"},null,-1))),u=[n];var o={__name:"AppLoader",props:{app:Boolean},setup(e){return(r,l)=>((0,a.wg)(),(0,a.iD)("div",{class:(0,t.C_)(["container",{container__app:e.app}])},u,2))}},c=l(89);const i=(0,c.Z)(o,[["__scopeId","data-v-6cd2041e"]]);var m=i},7870:function(e,r,l){l.r(r),l.d(r,{default:function(){return M}});l(7658);var a=l(3396),t=l(4870),s=l(7139),n=l(9242),u=l(2483),o=l(1434),c=l(2474),i=l(657),m=l(5227),d=(e,r)=>{const l=(0,a.Fl)((()=>Object.entries(r).reduce(((r,[l,a])=>{const t=(0,m.n8)(e[l],a)?.[0];return"string"===typeof t?{...r,[l]:t}:r}),{}))),t=(0,a.Fl)((()=>Object.values(l.value).some(Boolean)));return{errors:l,isInvalid:t}};const p={class:"form__label"},_={class:"form__value"},v={key:0,class:"form__error"};var b={__name:"AppFormField",props:{label:String,msg:String},setup(e){return(r,l)=>((0,a.wg)(),(0,a.iD)("label",p,[(0,a.WI)(r.$slots,"default"),(0,a._)("span",_,(0,s.zw)(e.label),1),e.msg?((0,a.wg)(),(0,a.iD)("span",v,(0,s.zw)(e.msg),1)):(0,a.kq)("",!0)]))}};const g=b;var f=g;const S=["value","type","placeholder"];var h={__name:"AppFormInput",props:{modelValue:[Number,String],label:String,placeholder:String,type:String,rules:Array,error:String},emits:["update:modelValue"],setup(e,{emit:r}){const l=e,{rules:s,modelValue:n,error:u}=(0,t.BK)(l),o=(0,t.iH)(""),c=(0,a.Fl)((()=>o.value||u.value||"")),i=e=>{o.value="";const r=!!s.value?.length,l=()=>(0,m.n8)(s.value,e)[0]??"";o.value=r?l():""},d=e=>{i(e),r("update:modelValue",e)};return(0,a.bv)((()=>n.value&&i(n.value))),(r,l)=>((0,a.wg)(),(0,a.j4)(f,{msg:(0,t.SU)(c),label:e.label},{default:(0,a.w5)((()=>[(0,a._)("input",{onInput:l[0]||(l[0]=e=>d(e.target.value.trim())),onBlur:l[1]||(l[1]=e=>i(e.target.value.trim())),value:(0,t.SU)(n),type:e.type,placeholder:e.placeholder,class:"form__input"},null,40,S)])),_:1},8,["msg","label"]))}};const y=h;var U=y;const w=["value","placeholder"];var k={__name:"AppFormTextArea",props:{label:String,msg:String,placeholder:String,modelValue:[Number,String]},emits:["update:modelValue"],setup(e){return(r,l)=>((0,a.wg)(),(0,a.j4)(f,{msg:e.msg,label:e.label},{default:(0,a.w5)((()=>[(0,a._)("textarea",{onInput:l[0]||(l[0]=e=>r.$emit("update:modelValue",e.target.value)),value:e.modelValue,placeholder:e.placeholder,class:"form__input form__input--area"},null,40,w)])),_:1},8,["msg","label"]))}};const V=k;var F=V,z=l(6213);const O={class:"content container"},W={class:"content__top"},j={class:"breadcrumbs"},q={class:"breadcrumbs__item"},D={class:"breadcrumbs__item"},I=(0,a._)("li",{class:"breadcrumbs__item"},[(0,a._)("a",{class:"breadcrumbs__link"}," Оформление заказа ")],-1),C=(0,a._)("h1",{class:"content__title"},"Корзина",-1),E={class:"content__info"},x={class:"cart"},A=["onSubmit"],B={class:"cart__field"},H={class:"cart__data"},L={class:"cart__block"},$={class:"cart__orders"},Z={class:"cart__total"},K=["disabled"],N={key:0,class:"cart__error form__error-block"},T=(0,a._)("h4",null,"Заявка не отправлена!",-1);var P={__name:"OrderPage",setup(e){const r=(0,c.x)(),l=(0,i.L)(),p=(0,u.tv)(),_=(0,a.Fl)((()=>{const e=r.itemsCount,l=(0,m.m5)(e,["товар","товара","товаров"]);return`${e} ${l}`})),v=500,b=(0,t.qj)({name:"",address:"",phone:"",email:"",comment:""}),g={name:[e=>!!e||"Заполните ФИО",e=>/^[a-zа-яё ]+$/i.test(e)||"Недопустимые символы"],address:[e=>!!e||"Заполните адрес"],phone:[e=>!!e||"Заполните телефон",e=>/^[+\d]+$/.test(e)||"Недопустимые символы"],email:[e=>!!e||"Заполните E-mail",e=>/.+@.+\..+/.test(e)||"Неккоректно введен E-mail"]},{isInvalid:f}=d(g,b),S=async()=>{f.value||(await l.createOrder(b),l.isError||p.push({name:o.iU,params:{id:l.order.id}}))};return(e,u)=>{const c=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,t.SU)(l).isLoading?((0,a.wg)(),(0,a.j4)(z.Z,{key:0,app:""})):(0,a.kq)("",!0),(0,a._)("main",O,[(0,a._)("div",W,[(0,a._)("ul",j,[(0,a._)("li",q,[(0,a.Wm)(c,{class:"breadcrumbs__link",to:{name:(0,t.SU)(o.e0)}},{default:(0,a.w5)((()=>[(0,a.Uk)(" Каталог ")])),_:1},8,["to"])]),(0,a._)("li",D,[(0,a.Wm)(c,{class:"breadcrumbs__link",to:{name:(0,t.SU)(o.TW)}},{default:(0,a.w5)((()=>[(0,a.Uk)(" Корзина ")])),_:1},8,["to"])]),I]),C,(0,a._)("span",E,(0,s.zw)((0,t.SU)(_)),1)]),(0,a._)("section",x,[(0,a._)("form",{onSubmit:(0,n.iM)(S,["prevent"]),ref:"form",class:"cart__form form"},[(0,a._)("div",B,[(0,a._)("div",H,[(0,a.Wm)(U,{modelValue:b.name,"onUpdate:modelValue":u[0]||(u[0]=e=>b.name=e),type:"text",placeholder:"Введите ваше полное имя",label:"ФИО*",rules:g.name,error:(0,t.SU)(l).errors.inputs.name},null,8,["modelValue","rules","error"]),(0,a.Wm)(U,{modelValue:b.address,"onUpdate:modelValue":u[1]||(u[1]=e=>b.address=e),type:"text",placeholder:"Введите ваш адрес",label:"Адрес доставки*",rules:g.address,error:(0,t.SU)(l).errors.inputs.address},null,8,["modelValue","rules","error"]),(0,a.Wm)(U,{modelValue:b.phone,"onUpdate:modelValue":u[2]||(u[2]=e=>b.phone=e),type:"tel",placeholder:"Введите ваш телефон",label:"Телефон*",rules:g.phone,error:(0,t.SU)(l).errors.inputs.phone},null,8,["modelValue","rules","error"]),(0,a.Wm)(U,{modelValue:b.email,"onUpdate:modelValue":u[3]||(u[3]=e=>b.email=e),type:"email",placeholder:"Введи ваш Email",label:"Email*",rules:g.email,error:(0,t.SU)(l).errors.inputs.email},null,8,["modelValue","rules","error"]),(0,a.Wm)(F,{modelValue:b.comment,"onUpdate:modelValue":u[4]||(u[4]=e=>b.comment=e),placeholder:"Ваши пожелания",label:"Комментарий к заказу"},null,8,["modelValue"])])]),(0,a._)("div",L,[(0,a._)("ul",$,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((0,t.SU)(r).items,(({product:e,quantity:r})=>((0,a.wg)(),(0,a.iD)("li",{key:e.id,class:"cart__order"},[(0,a._)("h3",null,(0,s.zw)(e.title),1),(0,a._)("b",null,(0,s.zw)((0,t.SU)(m.e8)(e.price*r))+" ₽",1),(0,a._)("span",null,"Артикул: "+(0,s.zw)(e.id),1)])))),128))]),(0,a._)("div",Z,[(0,a._)("p",null,[(0,a.Uk)(" Доставка: "),(0,a._)("b",null,(0,s.zw)(v)+" ₽")]),(0,a._)("p",null,[(0,a.Uk)(" Итого: "),(0,a._)("b",null,(0,s.zw)((0,t.SU)(_)),1),(0,a.Uk)(" на сумму "),(0,a._)("b",null,(0,s.zw)((0,t.SU)(m.e8)((0,t.SU)(r).cartTotal+v))+" ₽",1)])]),(0,a._)("button",{disabled:(0,t.SU)(f),class:"cart__button button button--primery",type:"submit"}," Оформить заказ ",8,K)]),(0,t.SU)(l).isError?((0,a.wg)(),(0,a.iD)("div",N,[T,(0,a._)("p",null,(0,s.zw)((0,t.SU)(l).errors.message?(0,t.SU)(l).errors.message:"Похоже произошла ошибка. Попробуйте отправить снова или перезагрузите страницу."),1)])):(0,a.kq)("",!0)],40,A)])])],64)}}};const Y=P;var M=Y}}]);
//# sourceMappingURL=870.827d8564.js.map